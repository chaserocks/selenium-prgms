package FW;

import java.io.FileInputStream;
import java.lang.reflect.InvocationTargetException;
import java.lang.reflect.Method;
import java.util.Iterator;
import org.apache.poi.ss.usermodel.Row;
import org.apache.poi.xssf.usermodel.XSSFSheet;
import org.apache.poi.xssf.usermodel.XSSFWorkbook;
import org.testng.annotations.Test;

public class GmailLoginusingReflections {
	KeywrdGmaillgnusingxlfile keys=new KeywrdGmaillgnusingxlfile();
	Method[] Methods=keys.getClass().getMethods();
	@Test
	public void loginTest() throws InvocationTargetException, Exception, Throwable {
	FileInputStream f=new FileInputStream("E:\\Mystuff\\SELINUMWS\\Frameworks\\src\\com\\mbc\\excelfiles\\LoginKeywordxlfile.xlsx");
	XSSFWorkbook wb=new XSSFWorkbook(f);
	XSSFSheet ws=wb.getSheet("Sheet1");
	Iterator<Row> row=ws.iterator();
	row.next();
	while(row.hasNext())
	{
		Row r=row.next();
		String Action=r.getCell(3).getStringCellValue();
		executeMethods(Action);
		}
	}
public void executeMethods(String Action) throws Exception, Throwable, InvocationTargetException 
{
	for(int i=0;i<=Methods.length;i++)
	{
		if(Action.equals(Methods[i].getName()))
		{
			Methods[i].invoke(keys);
			break;
		}
	}
}
}
